{% block body %}
<section>
    <div id="edit-movement-module">
        <div class="header-buttons">
            <div class="btn-group main-buttons">
                <button v-if="movementCanEdit"
                    class="btn btn-warning cWhite"
                    @click="onEdit">
                    <span class="glyphicon glyphicon-floppy-disk"></span>
                    Editar
                </button>
                <button v-if="movementType != 7 && movementCanReceive"
                    class="btn btn-primary cWhite"
                    @click="onDo">
                    <span class="glyphicon glyphicon-ok"></span>
                    Realizar
                </button>
                <button v-if="movementType == 7 && movementCanReceive"
                    class="btn btn-primary cWhite"
                    @click="onDo">
                    <span class="glyphicon glyphicon-ok"></span>
                    Dar Salida
                </button>
                <button v-if="movementType != 7 && movementStatusId == 4"
                    class="btn btn-warning cWhite"
                    @click="changeMovementStatus(6)">
                    <span class="glyphicon glyphicon-ok"></span>
                    Finalizar Parcialmente
                </button>
                <button v-if="movementStatusId == 1"
                    class="btn btn-success"
                    @click="changeMovementStatus(2)">
                    <span class="glyphicon glyphicon-ok"></span>
                    Autorizar
                </button>
            </div>
            <div class="btn-group secondary-buttons pull-right">
                <button v-if="movementStatusId == 1"
                    class="btn btn-warning cWhite"
                    @click="changeMovementStatus(8)">
                    <span class="glyphicon glyphicon glyphicon-remove"></span>
                    No Autorizar
                </button>
                <button v-if="movementStatusId != 5 && movementStatusId != 6 && movementStatusId != 7 && movementStatusId != 8"
                    class="btn btn-danger cWhite"
                    @click="changeMovementStatus(7)">
                    <span class="glyphicon glyphicon glyphicon-remove"></span>
                    Cancelar
                </button>
            </div>
        </div>
        <div class="panel-content">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel-group" role="tablist">
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" href="#movement" aria-expanded="true">
                                        Datos del Movimiento No. ${movementId} <i class="fa fa-caret-down" aria-hidden="true"></i>
                                    </a>
                                </h4>
                            </div>
                            <div id="movement" class="panel-collapse collapse in" role="tabpanel">
                                <div class="panel-body">

                                    <div class="row">
                                        <div class="col-md-12">
                                            <h4 style="display: inline;">Estatus:</h4>
                                            <h3 style="display: inline;">${movementStatusDescription} ${movementStatusExtraDescription}</h3>
                                        </div>
                                    </div>

                                    <br>

                                    <div class="row">

                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label>Tipo de Movimiento:</label>
                                                <input type="text" :placeholder="movementTypeDescription" disabled>
                                            </div>
                                        </div>

                                        <div class="col-md-4">
                                            <div v-if="movementType != 4" class="form-group">
                                                <label v-if="movementType == 1">Proveedor Origen:</label>
                                                <label v-if="movementType == 3 || movementType == 5 || movementType == 7 || movementType == 8">Almacen Origen:</label>
                                                <input type="text" :placeholder="movementOriginDescription" disabled>
                                            </div>
                                        </div>

                                        <div class="col-md-4">
                                            <div v-if="movementType != 8" class="form-group">
                                                <label v-if="movementType == 1 || movementType == 3 || movementType == 4 || movementType == 7">Almacen Destino:</label>
                                                <label v-if="movementType == 5">Cliente Destino:</label>
                                                <input type="text" :placeholder="movementDestinyDescription" disabled>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="row">

                                        <div class="col-md-4">
                                            <div v-if="movementType == 1" class="form-group">
                                                <label>Folio Compra:</label>
                                                <input type="text" :placeholder="movementRef" disabled>
                                            </div>
                                        </div>

                                        <div class="col-md-4">
                                            <div v-if="movementType == 1" class="form-group">
                                                <label>Folios Facturas:</label>
                                                <el-select
                                                    v-model="invoices"
                                                    multiple
                                                    filterable
                                                    allow-create
                                                    placeholder="Folios">
                                                    <el-option
                                                      v-for="item in listInvoices"
                                                      :key="item.id"
                                                      :label="item.folio"
                                                      :value="item.id">
                                                    </el-option>
                                                </el-select>
                                            </div>
                                        </div>

                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label>Comentarios:</label>
                                                <textarea maxlength="255" style="resize: none;" v-model="movementDescription" disabled></textarea>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="panel-group" role="tablist">
                        <div class="panel panel-default">

                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" href="#productsDetails" aria-expanded="true">
                                        Productos <i class="fa fa-caret-down" aria-hidden="true"></i>
                                    </a>
                                </h4>
                            </div>
                            <div id="productsDetails" class="panel-collapse collapse in" role="tabpanel">
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-md-12 table-responsive">
                                            <vue-dynamic-table
                                                    class-name="table"
                                                    :columns="sourceColumnsProducts"
                                                    :data-model="listProducts">
                                                        <template slot="no-rows-found">
                                                            <h4 class="text-center"><span class="glyphicon glyphicon-zoom-in"></span>
                                                                Sin Excepciones de Productos
                                                            </h4>
                                                        </template>
                                                        <template slot="productUnit" scope="row">
                                                            <template v-if="row.object.unit != null">
                                                                ${row.object.unit.name}
                                                            </template>
                                                        </template>
                                                        <template slot="productDescription" scope="row">
                                                            <div class="expand">
                                                                ${row.object.description}
                                                            </div>
                                                        </template>
                                                        <template slot="productToReceive" scope="row">
                                                            ${row.object.pivot.to_receive}
                                                        </template>
                                                        <template slot="productReceived" scope="row">
                                                            ${row.object.pivot.quantity}
                                                        </template>
                                                        <template slot="productExtraData" scope="row">
                                                            ${row.object.pivot.refQuantity}
                                                        </template>
                                            </vue-dynamic-table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="panel-group" role="tablist">
                        <div class="panel panel-default">

                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" href="#sendDetails" aria-expanded="true">
                                        Datos de Envio <i class="fa fa-caret-down" aria-hidden="true"></i>
                                    </a>
                                </h4>
                            </div>
                            <div id="sendDetails" class="panel-collapse collapse in" role="tabpanel">
                                <div class="panel-body">


                                    <div v-if="movementType == 4 || movementType == 8" class="row">
                                        <div class="col-md-4">
                                            No Aplican datos de envio
                                        </div>
                                    </div>

                                    <div v-else class="row">
                                        <div class="col-md-4">
                                            Aqui van muchos datos de envio pues
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
{% block loadScripts %}
    <script id="scriptContainer" type="text/javascript">
    
        uiVars['movement'] = {{ movement|json_encode|raw }};
        init.length = 0;
        init = [ {
            title: "Edición de Movimiento No.: " + uiVars['movement'].id,
            file: 'Warehouse/Movements/editMovement.js',
            functions: [ {
                name: 'iniciarModuloEditMovement',
                args: [ uiVars['movement'] ]
            } ]
        } ];

    </script>
{% endblock %}
