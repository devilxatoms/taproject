{% block body %}
<section id="register-group-form">
  <div class="header-buttons">
    <div class="btn-group main-buttons">
      <button 
        type="button" 
        name="button" 
        v-on:click="registerGroup" 
        class="btn btn-primary">
        Registrar
      </button>
    </div>
  </div>
  <div class="panel-content">
    <div class="box box-primary fullHeight">
      <div class="box-container">
        <div class="box-title">
          <h4> Registro de Grupos</h4>
        </div>
        <form >
        <!-- <h5 class="box-title">Datos para Autenticación</h5> -->
          <div class="form-group">
            <label for="grupo">Grupo:</label>
            <input v-validate="'required'" type="text" class="form-control" id="rf-user" placeholder="Introducir Grupo" name="grupo">
            <span class="cRed" v-show="errors.has('grupo')">${ errors.first('grupo') }</span>
          </div>
          <div class="form-group">
            <label for="descripcion">Descripción:</label>
            <textarea class="form-control" id="rf-pass" placeholder="Introducir Descripción" name="descripcion"></textarea>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

{% endblock %}
{% block loadScripts %}
 <script id="scriptContainer" type="text/javascript">
 var registerGroupForm = new Vue({
    el: '#register-group-form',
    data: {
    },
    mounted: function() {

    },
    methods: {
      registerGroup:function(){
        this.$validator.validateAll().then(() => {

          var groupData = $('#register-group-form input, #register-group-form textarea').serializeArray();
          var jsonGroupData = {};
          $.each(groupData, function(i, item) {
              jsonGroupData[item.name] = item.value;
          });

          $.ajax({
              url: AJAX_PATH + 'dashboard/group/register',
              data: jsonGroupData,
              type: 'POST'
          }).done( function( response ) {

            switch (response.data[0].status) {
              case 0:
              this.$message({
                        message: 'El Grupo No Puede Ser Registrado.',
                        type: 'warning'
                    });
                break;
             case 1:
             this.$message({
                       message: 'Registro exitoso.',
                       type: 'success'
                   });
             groupsTable.loadGroups();
                  break;
              default:
              this.$message({
                        message: 'El Grupo No Puede Ser Registrado.',
                        type: 'warning'
                    });
                break;
            }

          }.bind(this));

        }).catch(( ) => {
          this.$message({
            message: 'Completa el formulario como se indica.',
            type: 'warning'
          });
        });

      }
    },
    computed: {
    },
    watch: {
    },
    delimiters: ['${', '}']
  });
 </script>
{% endblock %}
