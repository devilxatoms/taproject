{% block content %}
<section>
    <div id="createContactContainer">
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">${contactDetailsTitle}</h3>
                    </div>
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>* Nombre:</label>
                                    <input type="text" v-model="contact.name">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>Área:</label>
                                    <input type="text" v-model="contact.workArea">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>Descripción:</label>
                                    <input type="text" v-model="contact.description">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Telefonos:</h5>
                                <template v-for="(phone, idx) in contact.phones">
                                    <div v-if="!phone.hasOwnProperty('isDeleted') || !phone.isDeleted">
                                        <div class="form-group">
                                            <div class="input-group">
                                                <input type="text" v-model="phone.phone">
                                                
                                                    <span class="input-group-addon">
                                                        <span class="fa fa-trash-o" v-on:click="deletePhone(idx)"></span>
                                                    </span>
                                                
                                            </div>
                                        </div>
                                    </div>
                                </template>
                                <a style="cursor: pointer;" v-on:click="addPhone"><span class="fa fa-plus"></span> Agregar telefono</a>
                            </div>
                            <div class="col-md-6">
                                <h5>Correos:</h5>
                                <template v-for="(mail, idx) in contact.mails">
                                    <div v-if="!mail.hasOwnProperty('isDeleted') || !mail.isDeleted">
                                        <div class="form-group">
                                            <div class="input-group">
                                                <input type="text" v-model="mail.email">
                                                    <span class="input-group-addon fa fa-envelope-o" style="margin-right: 15px;">
                                                        {# TODO: set click listener and perform action to send mail #}
                                                    </span>
                                                    <span class="input-group-addon fa fa-trash-o" v-on:click="deleteMail(idx)">
                                                    </span>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                                <a style="cursor: pointer;" v-on:click="addMail"><span class="fa fa-plus"></span> Agregar correo</a>
                            </div>
                        </div>
                        <div class="row" style="margin-top: 10px;">
                            <div class="col-md-12">
                                <button type="button" class="btn btn-primary pull-right" @click="saveContact">
                                    <span class="fa fa-floppy-o"></span> Guardar
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="panel-footer"></div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
{% block loadScripts %}
<script id="scriptContainer" type="text/javascript">
init.length = 0;
{% if contact %}
uiVars['tabTitle'] = 'Editar contacto';
uiVars['contact'] = {{ contact | json_encode | raw}};
uiVars['contactDetailsTitle'] = 'Editar datos de contacto';
{% else %}
uiVars['tabTitle'] = 'Agregar contacto';
uiVars['contact'] = null;
uiVars['contactDetailsTitle'] = 'Agregar contacto nuevo';
{% endif %}
uiVars['subsidiaryId'] = {{ subsidiaryId }}
init=[{
    title: uiVars['tabTitle'],
    file: 'CrmJs/Prospect/createContact.js',
    functions: [{
      name: 'initContactForm',
      args: [
        uiVars['subsidiaryId'],
        uiVars['contact'],
        uiVars['contactDetailsTitle']
      ]
    }]
}];
</script>
{% endblock %}